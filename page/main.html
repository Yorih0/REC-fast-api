<!-- main.html -->
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReCharge - Ремонт электромобилей</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/toast.css">
</head>
<body>
    <main class="main-container">
        <header class="header">
            <div class="logo" onclick="Back()">
                <div class="shine">ReCharge</div>
            </div>
            <nav class="nav">
                <div id="Choose_Enter_or_Login"></div>
            </nav>
        </header>

        <section class="hero">
            <div class="hero-content">
                <div class="hero-text">
                    <h1 class="hero-title">Ваше авто <br><span class="hero-title-no-wrap">в надёжных руках</span></h1>
                    <p class="hero-subtitle">От планового обслуживания <br>до модернизации</p>
                    <div class="hero-buttons">
                        <button class="hero-btn-light" onclick="createOrder()">Записаться</button>
                        <button class="hero-btn-dark" onclick="scrollToServices()">Услуги</button>
                    </div>
                </div>
            </div>
        </section>

        <div class="zag1">Что мы делаем</div>

        <section class="stats">
            <div class="stats-container">
                <div class="stat-item">
                    <div class="stat-number" data-target="12" data-suffix="K">0</div>
                    <div class="stat-label">Обслуженных автомобилей</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" data-target="15" data-suffix=" лет">0</div>
                    <div class="stat-label">Облуживания ваших авто</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" data-target="98" data-suffix="%">0</div>
                    <div class="stat-label">Клиентов возвращаются снова</div>
                </div>
            </div>
            <div class="stats-description">
                Мы обслуживаем и ремонтируем электромобили любой марки. От диагностики до сложных технических работ — всё под ключ, с гарантией и гибким графиком.
            </div>
            
            <div class="zag2" id="services">Популярные Услуги</div>
            
            <div class="services container">
                <div data-text="Тормозной диск" style="--r:-15;" class="glass">
                    <img src="png/disk.png" alt="Тормозной диск" style="width: 310px; height: 310px;">
                </div>
                <div data-text="Батарея" style="--r:5;" class="glass">
                    <img src="png/battery.png" alt="Батарея" style="width: 310px; height: 310px;">
                </div>
                <div data-text="Система охлаждения" style="--r:25;" class="glass">
                    <img src="png/hla.png" alt="Система охлаждения" style="width: 310px; height: 310px;">
                </div>
            </div>
        </section>

        <footer class="footer">
            <div class="footer-line"></div>
            <div class="footer-content">
                <div class="footer-phone">+3752945674893</div>
                <div class="footer-copyright">ReCharge 2025 ©</div>
                <div class="footer-email">Recharge@gmail.com</div>
            </div>
        </footer>
    </main>

    <script src="js/General.js"></script>
    <script>
        // Функция скролла к разделу услуг - ИСПРАВЛЕННАЯ ВЕРСИЯ
        function scrollToServices() {
            // Ищем первый подходящий элемент
            let section = null;
            
            // Сначала по id
            const byId = document.getElementById('services');
            if (byId) {
                section = byId;
            } 
            // Затем по классу .zag2 (первый элемент)
            else if (document.querySelector('.zag2')) {
                section = document.querySelector('.zag2');
            }
            // Затем по классу .services (первый элемент)
            else if (document.querySelector('.services')) {
                section = document.querySelector('.services');
            }
            
            // Проверяем, что нашли элемент и это DOM-элемент
            if (!section || !section.getBoundingClientRect) {
                console.error('Раздел услуг не найден или не является DOM-элементом!', section);
                return;
            }
            
            // Получаем позицию элемента
            const elementTop = section.getBoundingClientRect().top;
            const offsetPosition = elementTop + window.pageYOffset - 80;
            
            console.log('Скроллим к элементу:', section);
            console.log('Позиция:', offsetPosition);
            
            // Плавный скролл
            window.scrollTo({
                top: offsetPosition,
                behavior: 'smooth'
            });
        }
        
        // Альтернативная версия функции - более простая и надежная
        function scrollToServicesSimple() {
            // Просто ищем элемент по id
            const servicesElement = document.getElementById('services');
            
            if (!servicesElement) {
                console.error('Элемент с id="services" не найден!');
                return;
            }
            
            // Используем scrollIntoView для простоты
            servicesElement.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
        
        // Анимация счетчиков
        function animateCounters() {
            const counters = document.querySelectorAll('.stat-number');
            
            counters.forEach(counter => {
                const target = parseFloat(counter.getAttribute('data-target'));
                const prefix = counter.getAttribute('data-prefix') || '';
                const suffix = counter.getAttribute('data-suffix') || '';
                const duration = 3000;
                const startTime = performance.now();
                const startValue = 0;
                
                function updateCounter(currentTime) {
                    const elapsed = currentTime - startTime;
                    const progress = Math.min(elapsed / duration, 1);
                    
                    const easeOut = 1 - Math.pow(1 - progress, 3);
                    const currentValue = startValue + (target - startValue) * easeOut;
                    
                    let displayValue;
                    if (suffix.includes('K')) {
                        displayValue = Math.floor(currentValue);
                    } else if (suffix.includes('%')) {
                        displayValue = Math.floor(currentValue);
                    } else {
                        displayValue = Math.floor(currentValue);
                    }
                    
                    counter.textContent = prefix + displayValue + suffix;
                    
                    if (progress < 1) {
                        requestAnimationFrame(updateCounter);
                    } else {
                        let finalValue;
                        if (suffix.includes('K')) {
                            finalValue = Math.floor(target);
                        } else if (suffix.includes('%')) {
                            finalValue = Math.floor(target);
                        } else {
                            finalValue = Math.floor(target);
                        }
                        counter.textContent = prefix + finalValue + suffix;
                    }
                }
                
                setTimeout(() => {
                    requestAnimationFrame(updateCounter);
                }, 200);
            });
        }
        
        // Функции для управления аккаунтом
        function Enter() {
            window.location.href = "/login";
        }
        
        function createOrder() {
            if (!hasHashkeyCookie()) {
                window.location.href = "/login";
            } else {
                window.location.href = "/order";
            }
        }
        
        function Exit() {
            document.cookie = "hashkey=; path=/; max-age=0";
            showToast("Вы вышли из аккаунта", "info");
            View_btns();
        }
        
        function View_btns() {
            const Choose_Enter_or_Login = document.getElementById("Choose_Enter_or_Login");
            Choose_Enter_or_Login.innerHTML = "";
            
            if (hasHashkeyCookie()) {
                const profileBtn = document.createElement("button");
                profileBtn.type = "button";
                profileBtn.className = "services-btn";
                profileBtn.textContent = "Профиль";
                profileBtn.onclick = Profile;
                Choose_Enter_or_Login.appendChild(profileBtn);
            } else {
                const loginBtn = document.createElement("button");
                loginBtn.type = "button";
                loginBtn.className = "services-btn";
                loginBtn.textContent = "Вход";
                loginBtn.onclick = Enter;
                Choose_Enter_or_Login.appendChild(loginBtn);
            }
        }
        
        // Инициализация при загрузке
        document.addEventListener("DOMContentLoaded", function() {
            View_btns();
            animateCounters();
            
            // Добавляем обработчик для кнопки "Назад" если функция Back существует
            if (typeof Back === 'function') {
                document.querySelector('.logo').addEventListener('click', Back);
            }
            
            // Для отладки
            console.log('Проверка элемента services:');
            console.log('- document.getElementById("services"):', document.getElementById('services'));
            console.log('- Тип элемента:', typeof document.getElementById('services'));
            console.log('- Есть ли getBoundingClientRect?:', 
                       document.getElementById('services')?.getBoundingClientRect ? 'Да' : 'Нет');
            
            // Если нужно, используем простую версию
            // Замените scrollToServices на scrollToServicesSimple в кнопке, если эта не работает
        });
    </script>
</body>
</html>